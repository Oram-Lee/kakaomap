<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>í…Œí—¤ë€ë¡œ ë¹Œë”© ì§€ë„</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        
        #header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        #header h1 { 
            margin: 0; 
            font-size: 24px; 
            font-weight: 500;
        }
        
        #controls {
            background: white;
            padding: 10px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            border-radius: 25px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .filter-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        #map {
            width: 100%;
            height: calc(100vh - 120px);
        }
        
        .building-label {
            background: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: 2px solid;
        }
        
        .info-window {
            padding: 15px;
            max-width: 300px;
        }
        
        .info-window h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 16px;
        }
        
        .info-window p {
            margin: 5px 0;
            font-size: 14px;
            color: #555;
        }
        
        .info-window .investigator {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            color: white;
            font-size: 12px;
            font-weight: 500;
            margin-top: 5px;
        }
        
        #legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        #legend h4 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #2c3e50;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        #stats {
            position: absolute;
            top: 120px;
            left: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>ğŸ¢ í…Œí—¤ë€ë¡œ ë¹Œë”© í˜„ì¥ì¡°ì‚¬ ì§€ë„</h1>
    </div>
    
    <div id="controls">
        <button class="filter-btn active" onclick="showAll()">ì „ì²´ ë³´ê¸°</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì†Œë‚˜ë¬´')">ì†Œë‚˜ë¬´</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì•ˆì¤€í¬')">ì•ˆì¤€í¬</button>
        <button class="filter-btn" onclick="filterByInvestigator('ë‚¨ë¯¼ì¤€')">ë‚¨ë¯¼ì¤€</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì´ìŠ¬ë¹„')">ì´ìŠ¬ë¹„</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì˜¤ì‹œì˜')">ì˜¤ì‹œì˜</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì¡°ì€ì•„')">ì¡°ì€ì•„</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì´ì˜¤ëŒ')">ì´ì˜¤ëŒ</button>
        <button class="filter-btn" onclick="filterByInvestigator('ì‹¬ì •ì›')">ì‹¬ì •ì›</button>
    </div>
    
    <div id="map"></div>
    
    <div id="stats">
        <strong>ì´ ë¹Œë”©:</strong> 0ê°œ<br>
        <strong>í‘œì‹œëœ ë¹Œë”©:</strong> <span id="shown-count">0</span>ê°œ
    </div>
    
    <div id="legend">
        <h4>ë‹´ë‹¹ì ìƒ‰ìƒ</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #e74c3c;"></div>
            <span>ì†Œë‚˜ë¬´</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #f39c12;"></div>
            <span>ì•ˆì¤€í¬</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #27ae60;"></div>
            <span>ë‚¨ë¯¼ì¤€</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #3498db;"></div>
            <span>ì´ìŠ¬ë¹„</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #9b59b6;"></div>
            <span>ì˜¤ì‹œì˜</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #1abc9c;"></div>
            <span>ì¡°ì€ì•„</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #e67e22;"></div>
            <span>ì´ì˜¤ëŒ</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #34495e;"></div>
            <span>ì‹¬ì •ì›</span>
        </div>
    </div>

    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1ac6eee9b1e4c2e0cc6f1d1ca1a6a559&libraries=services&autoload=false"></script>
    <script>
        const colors = {"ì†Œë‚˜ë¬´": "#e74c3c", "ì•ˆì¤€í¬": "#f39c12", "ë‚¨ë¯¼ì¤€": "#27ae60", "ì´ìŠ¬ë¹„": "#3498db", "ì˜¤ì‹œì˜": "#9b59b6", "ì¡°ì€ì•„": "#1abc9c", "ì´ì˜¤ëŒ": "#e67e22", "ì‹¬ì •ì›": "#34495e"};
        const buildings = [];
        
        let map;
        let overlays = [];
        let currentFilter = null;
        
        kakao.maps.load(function() {
            initMap();
        });
        
        function initMap() {
            const container = document.getElementById('map');
            const options = {
                center: new kakao.maps.LatLng(37.5000, 127.0320),
                level: 5
            };
            
            map = new kakao.maps.Map(container, options);
            
            // ì»¨íŠ¸ë¡¤ ì¶”ê°€
            map.addControl(new kakao.maps.MapTypeControl(), kakao.maps.ControlPosition.TOPRIGHT);
            map.addControl(new kakao.maps.ZoomControl(), kakao.maps.ControlPosition.RIGHT);
            
            // ëª¨ë“  ë¹Œë”© ë§ˆì»¤ ìƒì„±
            buildings.forEach(building => {
                createBuildingMarker(building);
            });
            
            // ì§€ë„ ë²”ìœ„ ìë™ ì¡°ì •
            fitMapToBounds();
        }
        
        function createBuildingMarker(building) {
            const position = new kakao.maps.LatLng(building.lat, building.lon);
            const color = colors[building.investigator] || '#999999';
            
            // ë¹Œë”©ëª… ë¼ë²¨
            const content = `<div class="building-label" style="border-color: ${color}; color: ${color};">${building.name}</div>`;
            
            const customOverlay = new kakao.maps.CustomOverlay({
                position: position,
                content: content,
                yAnchor: 0.5,
                clickable: true,
                zIndex: 1
            });
            
            customOverlay.setMap(map);
            
            // í´ë¦­ ì´ë²¤íŠ¸
            const overlayContent = customOverlay.getContent();
            overlayContent.addEventListener('click', function() {
                showInfoWindow(building, position);
            });
            
            // ì˜¤ë²„ë ˆì´ ì €ì¥
            overlays.push({
                overlay: customOverlay,
                building: building
            });
        }
        
        function showInfoWindow(building, position) {
            const color = colors[building.investigator] || '#999999';
            
            const content = `
                <div class="info-window">
                    <h3>${building.name}</h3>
                    <p><strong>ì£¼ì†Œ:</strong><br>${building.address}</p>
                    <div class="investigator" style="background: ${color};">
                        ë‹´ë‹¹: ${building.investigator}
                    </div>
                </div>
            `;
            
            const infowindow = new kakao.maps.InfoWindow({
                content: content,
                removable: true
            });
            
            // ë”ë¯¸ ë§ˆì»¤ (ì¸í¬ìœˆë„ìš° í‘œì‹œìš©)
            const marker = new kakao.maps.Marker({
                position: position
            });
            
            infowindow.open(map, marker);
        }
        
        function filterByInvestigator(investigator) {
            // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            currentFilter = investigator;
            
            // ì˜¤ë²„ë ˆì´ í•„í„°ë§
            let shownCount = 0;
            overlays.forEach(item => {
                if (item.building.investigator === investigator) {
                    item.overlay.setMap(map);
                    shownCount++;
                } else {
                    item.overlay.setMap(null);
                }
            });
            
            // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('shown-count').textContent = shownCount;
            
            // í•´ë‹¹ ë‹´ë‹¹ì ë¹Œë”©ë§Œ ë³´ì´ë„ë¡ ì§€ë„ ì¡°ì •
            fitMapToInvestigator(investigator);
        }
        
        function showAll() {
            // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.filter-btn').classList.add('active');
            
            currentFilter = null;
            
            // ëª¨ë“  ì˜¤ë²„ë ˆì´ í‘œì‹œ
            overlays.forEach(item => {
                item.overlay.setMap(map);
            });
            
            // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('shown-count').textContent = buildings.length;
            
            // ì „ì²´ ë²”ìœ„ë¡œ ì¡°ì •
            fitMapToBounds();
        }
        
        function fitMapToBounds() {
            const bounds = new kakao.maps.LatLngBounds();
            
            buildings.forEach(building => {
                bounds.extend(new kakao.maps.LatLng(building.lat, building.lon));
            });
            
            map.setBounds(bounds);
        }
        
        function fitMapToInvestigator(investigator) {
            const bounds = new kakao.maps.LatLngBounds();
            let count = 0;
            
            buildings.forEach(building => {
                if (building.investigator === investigator) {
                    bounds.extend(new kakao.maps.LatLng(building.lat, building.lon));
                    count++;
                }
            });
            
            if (count > 0) {
                map.setBounds(bounds);
            }
        }
    </script>
</body>
</html>
